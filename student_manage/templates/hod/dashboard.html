{% extends 'header.html' %}

{% load static %}


{% block body %}
<section class='index my-5'>
    <div class="row admin">
        <div class="col-12">
            <h1>Wellcome {{request.user.first_name}} sir !</h1>

            <span>Dashbord</span><span class='mx-2'>/</span><span class='text-secondary'> Admin Dashbord</span>

        </div>
    </div>
</section>

<section>
  <div class="row">
    <div class="col-xl-3 col-sm-6 col-12 d-flex ">
      <div class="card bg-comman w-100 shadow-lg p-3 mb-5 bg-white rounded">
        <div class="card-body">
          <div class="db-widgets d-flex justify-content-between align-items-center">
            <div class="db-info">
              <h6>Students</h6>
              <h3>{{student.count}}</h3>
            </div>
            <div class="db-icon">
              <img src="{% static 'images/icon/student.png' %}" alt="Dashboard Icon">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xl-3 col-sm-6 col-12 d-flex ">
      <div class="card bg-comman w-100 shadow-lg p-3 mb-5 bg-white rounded">
        <div class="card-body">
          <div class="db-widgets d-flex justify-content-between align-items-center">
            <div class="db-info">
              <h6>Teachers</h6>
              <h3>{{teacher.count}}</h3>
            </div>
            <div class="db-icon">
              <img src="{% static 'images/icon/teacher.png' %}" alt="Dashboard Icon">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xl-3 col-sm-6 col-12 d-flex ">
      <div class="card bg-comman w-100 shadow-lg p-3 mb-5 bg-white rounded">
        <div class="card-body">
          <div class="db-widgets d-flex justify-content-between align-items-center">
            <div class="db-info">
              <h6>Departments</h6>
              <h3> {{branch.count}}</h3>
            </div>
            <div class="db-icon">
              <img src="{% static 'images/icon/branch.png' %}" alt="Dashboard Icon">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xl-3 col-sm-6 col-12 d-flex ">
      <div class="card bg-comman w-100 shadow-lg p-3 mb-5 bg-white rounded">
        <div class="card-body">
          <div class="db-widgets d-flex justify-content-between align-items-center">
            <div class="db-info">
              <h6>courses</h6>
              <h3>{{course.count}}</h3>
            </div>
            <div class="db-icon">
              <img src="{% static 'images/icon/course.png' %}" alt="Dashboard Icon">
       
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<section class=''>
 
 
    <div class="row d-flex justify-content-between">
        <div class="col-md-12 col-lg-6 mt-3">   <div id="chart" class='shadow rounded bg-white rounded'></div></div>
        <div class="col-md-12 col-lg-6 mt-3"><div id="chart2" class='shadow bg-white rounded'></div></div>
        <div class="col-md-12 col-lg-6 mt-3">  <div id="chart3" class='shadow bg-white rounded'><h6 class='p-2'><b>All analysis</b></h6></div></div>
        <div class="col-md-12 col-lg-6 mt-3">  <div id="chart4" class='shadow bg-white rounded'><h6 class='p-2'><b>course Branch Subject</b></h6></div></div>
        <div class="col-md-12 col-lg-12 mt-3 ">  <div id="" class='shadow bg-white rounded pb-1'><h6 class='p-2'><b>Extra Notification</b></h6>
        <ul>
          {% if not teacher_leave_condition %}
          <li><a href="{% url 'leave_teacher' %}">You have  <b>{{teacher_leave_counter}}  Teacher leave</b> Pending </a></li>
          {% endif %}
          {% if not student_leave_condition %}
          <li><a href="{% url 'leave_student' %}">You have  <b>{{student_leave_counter}}  Student leave</b> Pending </a></li>
          {% endif %}
          {% if teacher_feedback_counter != 0 %}
          <li><a href="{% url 'feedback_teacher' %}">You have  <b>{{teacher_feedback_counter}}  Teachers Feedback </b> Pending </a></li>
          {% endif %}
          {% if student_feedback_counter != 0 %}
          <li><a href="{% url 'feedback_student' %}">You have  <b>{{student_feedback_counter}}  Student Feedback </b> Pending </a></li>
          {% endif %}
        </ul>
        </div></div>
    </div>
</section>

<section class="shadow-lg p-3 mt-3 mb-5 bg-white rounded">
  <h5>Our star student <span class='text-warning ml-1'><i class="fa-solid fa-crown"></i></span></h5>





<section>

    <table class="table table-striped">
        <thead>
            <tr>
                <th scope="col">Reg no</th>
                <th scope="col">Name</th>
                <th scope="col">Course </th>
                <th scope="col">Branch</th>
                <th scope="col">Sem</th>

            </tr>
        </thead>
        <tbody>
            {% for i in star_student %}
            <tr>
                <th scope="row">{{i.user.admin.username}}</th>
                <td>{{i.user.admin.first_name|capfirst}} {{i.user.admin.last_name}}</td>
                <td>{{i.user.course.name}}</td>
                <td>{{i.user.branch.name}}</td>
                <td>{{i.user.semester.name}}</td>

            </tr>
            {% endfor %}
        </tbody>
    </table>

</section>


<script>

    $(document).ready(function () {
        var options = {
            series: [{{student.count}}, {{teacher.count}}],
            chart: {
              height: 350,
              width:'100%',
                type: 'pie',
            },
            labels: ["Students", "Teachers",],
            theme: {
                monochrome: {
                    enabled: true
                }
            },
            plotOptions: {
                pie: {
                    dataLabels: {
                        offset: -5
                    }
                }
            },
            title: {
                text: "Total students and teachers"
            },
            dataLabels: {
                formatter(val, opts) {
                    const name = opts.w.globals.labels[opts.seriesIndex]
                    return [name, val.toFixed(1) + '%']
                }
            },
            legend: {
                show: false
            }
        };

        var chart = new ApexCharts(document.querySelector("#chart"), options);
        chart.render();





      
      
        var options = {
            series: [{
            name: 'Nit Graph',
            data: [{{course.count}}, {{branch.count}}, {{subject.count}}, {{sem.count}}, ]
          }],
            chart: {
            height: 350,
            width:'100%',
            type: 'bar',
          },
          plotOptions: {
            bar: {
              borderRadius: 10,
              dataLabels: {
                position: 'top', // top, center, bottom
              },
            }
          },
          dataLabels: {
            enabled: true,
            formatter: function (val) {
              return val ;
            },
            offsetY: -20,
            style: {
              fontSize: '12px',
              colors: ["#304758"]
            }
          },
          
          xaxis: {
            categories: ["course", "Branch", "subject", "Semistar", ],
            position: 'top',
            axisBorder: {
              show: false
            },
            axisTicks: {
              show: false
            },
            crosshairs: {
              fill: {
                type: 'gradient',
                gradient: {
                  colorFrom: '#D8E3F0',
                  colorTo: '#BED1E6',
                  stops: [0, 100],
                  opacityFrom: 0.4,
                  opacityTo: 0.5,
                }
              }
            },
            tooltip: {
              enabled: true,
            }
          },
          yaxis: {
            axisBorder: {
              show: false
            },
            axisTicks: {
              show: false,
            },
            labels: {
              show: false,
              formatter: function (val) {
                return val ;
              }
            }
          
          },
          title: {
            text: 'Department Management category',
            floating: true,
            offsetY: 330,
            align: 'center',
            style: {
              color: '#444'
            }
          }
          };
  
          var chart = new ApexCharts(document.querySelector("#chart2"), options);
          chart.render();


                
        var options = {
          series: [{{teacher.count}}, {{student.count}},{{course.count}},{{branch.count}},{{subject.count}}],
          chart: {
          
            height: 350,
            width:'100%',
          type: 'pie',
        },
        labels: ['Teachers', 'Students', 'course', 'Branches', 'Subject'],
        responsive: [{
          breakpoint: 480,
          options: {
            chart: {
             
              width: 200
            },
            legend: {
              position: 'bottom'
            }
          }
        }]
        };

        var chart = new ApexCharts(document.querySelector("#chart3"), options);
        chart.render();




        var options = {
          series: [{{course.count}}, {{branch.count}}, {{subject.count}}],
          chart: {
            height: 350,
            width:'100%',
          type: 'donut',
        },
        labels: [ 'course', 'Branches', 'Subject'],
        responsive: [{
          breakpoint: 480,
          options: {
            chart: {
              width: 200
            },
            legend: {
              position: 'bottom'
            }
          }
        }]
        };
    
        var chart = new ApexCharts(document.querySelector("#chart4"), options);
        chart.render();
    });


  
</script>
{% endblock body %}