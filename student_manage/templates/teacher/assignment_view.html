{% extends 'header.html' %}
{% load simpletag %}
{% block body %}
<section class='index my-3 '>
    <div class="row admin ">
        <div class="col-6 col-md-8">
            <h1>Assignment</h1>

            <span>
                <span>Assignment / <span class="text-secondary">Assignment Views</span></span>
            </span>

        </div>
        <div class="col-6 col-md-2 mt-3 ">

        </div>
    </div>
</section>

<section style="width: 100%; overflow-x: scroll;" >
{% include "msg.html" %}
 <table class="table table-striped table-hover ">
    <thead>
      <tr>
        <th scope="col">No.</th>
        <th scope="col">Assignment</th>
        <th scope="col">Student</th>
        <th scope="col">Offline</th>
        <th scope="col">Description</th>
        <th scope="col">File</th>
        <th scope="col">Mark</th>
      </tr>
    </thead>
    <tbody>
     
        {% for i in data %}
        <tr>
            <th scope="row">{{forloop.counter}}</th>
            <td>{{i.assignment.subject}}</td>
            <td>{{i.student.admin.first_name|capfirst}} {{i.student.admin.first_name}}({{i.student.admin.username}})</td>
            <td class="{% if i.offline %}text-primary{% endif %}">{{i.offline}}</td>
            <td>{{i.description|safe}}</td>
            <td>{% if i.file %} <a href="{{i.file.url}}" download class='btn btn-primary'>Download</a> {% else %} <button type="button" class="btn btn-primary" disabled>Empty</button> {% endif %}</td>
            <td>
                {% student_assignment_result_check i.id as result_check  %}

                {% if result_check %}
                <button type="button" class="btn btn-success" data-toggle="modal" data-target="#exampleModal{{i.id}}">
                    Edit
                  </button>
                  {% else %}
                  <button type="button" class="btn btn-info" data-toggle="modal" data-target="#exampleModal{{i.id}}">
                    Mark  
                  </button>
                {% endif %}
            </td>
          </tr>

         <!-- Modal -->
<div class="modal fade" id="exampleModal{{i.id}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">{{i.student.admin.first_name|capfirst}} {{i.student.admin.first_name}}({{i.student.admin.username}})</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
            {% student_assignment_result_check i.id as result_check  %}
             {% if result_check %}
             <form action="{% url 'teacher_assignment_result' %}" method="post">
                {% csrf_token %}
                <input type="hidden" name="assignment" value={{i.id}}>
                <label for="">Teacher accept:</label>
              
                <select name = "teacher_accept" id=""  class="form-control">
                    <option value='true' {% if i.assignment_result.teacher_accept %}
                      selected
                    {% endif %} >True</option>
                    <option value="false" {% if not i.assignment_result.teacher_accept %}
                    selected
                  {% endif %} >False</option>
                </select>
                <label for="">Teacher mark:</label>
                <input type="number" name="teacher_mark" value={{i.assignment_result.teacher_mark}}>
                <button type="submit" class='btn btn-primary'>Submit</button>
              </form>
             {% else %}
             <form action="{% url 'teacher_assignment_result' %}" method="post">
                {% csrf_token %}
                <input type="hidden" name="assignment" value={{i.id}}>
                {{fm.as_p}}
                <button type="submit" class='btn btn-primary'>Submit</button>
              </form>
             {% endif %}
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>

        </div>
      </div>
    </div>
  </div>
  {% empty %}
  <span class="text-danger">No one submitted</span>
        {% endfor %}

    </tbody>
  </table>
</section>
<a href="{% url 'teacher_assignment_list' %}" class='btn btn-danger'>Back</a>
{% endblock body %}

